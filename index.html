<html>
<head>
	<title>Optimzation using Dynamic Programming</title>
<link rel="stylesheet" href="mycss.css">

<!-- <script src="template.js"></script> -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
<!-- <style> -->

<!-- </style> -->
  <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML">
</script>
  </head>
  <body>

<h1 id="dynamic-programming-in-reinforcement-learning">Dynamic Programming in Reinforcement Learning</h1>

<p>

  Dynamic Programming can be used to compute optimal policies given a Markov Decision Process (MDP). Let us assume that the environment is a finite MDP. i.e. the state and the action sets, 
  <span class="math inline"> \(\mathcal{S} \) </span> 
  and 
  <span class="math inline"> \( \mathcal{A(s)} \) </span>
  ,for some 
  <span class="math inline"> \(s \in \mathcal{S} \) </span>, 
  are finite and that its dynamics are given by a set of transition probabilities, 
  <span class="math inline"> \( \mathcal{P}<em>{ss^{&#39;}}^{a}  = Pr{s</em>{t+1} =  s^{&#39;}|s<em>t = s,a</em>{t}=a } /) </span>
  and the expected immediate reward, 
  <span class="math inline"> \(\mathcal{R}<em>{ss^{&#39;}}^{a} = E{r</em>{t+1}|a<em>{t} = a, s</em>{t} =s,s_{t+1} = s^{&#39;}} \)</span>
  , for all 
  <span class="math inline"> \(s \in \mathcal{S}, a \in \mathcal{A}(s)$, and $s^{&#39;} \in \mathcal{S}^{+} \) </span> 
  <span class="math inline"> \($\mathcal{S}^{+} \) </span>
  is 
  <span class="math inline"> \(\mathcal{S} \) </span>
   plus a terminal state if the problem is episodic.

</p>


 <p><span class="math inline"> \(V^{\pi}_s =  E_{\pi} \{ r_{t+1} + \gamma r_{t+2} + \gamma r_{t+3} + ......| \hspace{0.1cm} s_{t} = s \} \) </span></p>

<p><span class="math inline"> \(\hspace{0.75cm} =  E_{\pi} \{ r_{t+1} + \gamma V^{\pi} (s_{t+1}) \hspace{0.1cm} | \hspace{0.1cm} s_{t} =s\} \) </span></p>

<p><span class="math inline"> \( \hspace{0.75cm} =  \sum _{a} \pi(s,a) \sum_{s^{'}} \mathcal {P}^{a}_{ss^{'}} 
[ \mathcal{R}^{a}_{ss^{'}} + \gamma V^{\pi}(s^{'}) ] \) </span></p>

<p><span class="math inline"> \( V_{k+1}(s) = E_{\pi} \{r_{t+1} + \gamma V_{k}(s_{t+1}) \hspace{0.1cm} | \hspace{0.1cm} s_{t} = s \} \) </span>

<p><span class="math inline"> \( \hspace{1.45cm} = \sum _{a} \pi(s,a) \sum_{s^{'}} \mathcal {P}^{a}_{ss^{'}} 
[\mathcal{R}^{a}_{ss^{'}} + \gamma V_{k}(s^{'})] \) </span></p>

<h3 id="algorithm-for-policy-evaluation">Algorithm for Policy Evaluation</h3>

<p>

  Input  <span class="math inline"> \(  \pi \) </span>, the policy to be evaluated <br> 
  Initialize  <span class="math inline"> \(V(s) = 0 \) </span>, for all <span class="math inline"> \( s \in \mathcal{S}^{+} \) </span> <br>
  Repeat<br>
    <span class="math inline"> \( \hspace{1cm} \Delta \leftarrow 0  \) </span> <br>
    <span class="math inline"> \( \hspace{1cm} \) </span> For each <span class="math inline"> \( s \in \mathcal{S} \) </span> :<br> 
      <span class="math inline"> \( \hspace{2cm} v \leftarrow V(s) \) </span> <br> 
      <span class="math inline"> \( \hspace{2cm} V(s) \leftarrow  \sum _{a}  \pi(s,a) \sum_{s^{'}} \mathcal {P}^{a}_{ss^{'}} 
      [\mathcal{R}^{a}_{ss^{'}} + \gamma V_{k}(s^{'})] \) </span> <br>
      <span class="math inline"> \( \hspace{2cm} \Delta \leftarrow \) </span> max  <span class="math inline"> \( ( \Delta, |v-V(s)|) \) </span><br>
  Until <span class="math inline"> \( \Delta &lt; \theta \) </span> (a small positive number)<br>
  Output <span class="math inline"> \( V \approx V^{\pi} \) 

</p>


    
 <h1 id="reliability-design">Reliability Design</h1>

    <p>The problem is to design a system that is composed of a several devices connected in the series. Let <span class="math inline">\(r_{i}\)</span> be the reliability of the device <span class="math inline">\(D_{i}\)</span>. Then the Reliability of the entire system is <span class="math inline">\(\prod r_{i}\)</span>. Even if the individual devices are very reliable, the reliability of the system may not be very good.</p>
<p>For example, if <span class="math inline">\(n=10\)</span> and <span class="math inline">\(r_{i}=0.99\)</span>, <span class="math inline">\(1\leq i\leq 10\)</span>, then <span class="math inline">\(\prod r_{i}=0.904\)</span>. Hence, it is desirable to duplicate the devices. Multiple copies of the same device type are connected in parallel through the use of switching circuits. The switching circuits determine which devices in any given group are functioning properly. They the make use of one such device at each stage. </p>

 <center>   
 <figure>
  <img src="NO_blog_image_01.png" alt="Reliability Design" style="width:50%">
  <figcaption>Figure-1: n devices are connected in series</figcaption>
</figure>
  <figure>
  <img src="NO_blog_image_02.png" alt="Reliability Design" style="width:50%">
  <figcaption>Figure-2: Multiple devices are connected in parallel in each stage</figcaption>

</figure>
</center>   

<p>
<p>If the stage <span class="math inline">\(i\)</span> contains <span class="math inline">\(m_{i}\)</span> copies of the device <span class="math inline">\(D_{i}\)</span>, then the probability that all <span class="math inline">\(m_{i}\)</span> have a malfunction is <span class="math inline">\(\left ( 1-r_{i} \right )^{m_{i}}\)</span>. Hence the reliability of the stage <span class="math inline">\(i\)</span> becomes <span class="math inline">\(1-\left ( 1-r_{i} \right )^{m_{i}}\)</span>. Thus, if <span class="math inline">\(r_{i}=0.99\)</span> and <span class="math inline">\(m_{i}=2\)</span>, the stage reliability becomes <span class="math inline">\(0.9999\)</span>.</p>
    
<p>In any practical situation, the stage reliability is little less than <span class="math inline">\(1-\left ( 1-r_{i} \right )^{m_{i}}\)</span> because the switching circuits themselves are not fully reliable. Also, failure of copies of the same device may not be fully independent.</p>
<p>Let us assume that reliabilty of stage <span class="math inline">\(i\)</span> is given by a function <span class="math inline">\(\Phi _{i} \left ( m_{i} \right ), 1\le n\)</span>. Therefore, the reliability of the system of stages is <span class="math inline">\(\prod_{1 \le i \le n}{\Phi _{i}\left ( m_{i} \right ) }\)</span>.</p>
<p>Our problem is to use device duplication to maximize reliability. This maximization of the reliability is carried under the cost constraint. Let <span class="math inline">\(c_{i}\)</span> be the cost of the unit device i and c be the maximum allowable cost of the system being designed. We wish to solve the following maximization problem.</p>
<p>The following is the problem statement.</p>
    
<div class="center">
<p><strong>maximize</strong> <span class="math inline">\(\Phi _{i} \left ( m_{i} \right ), 1\le n\)</span></p>
<p><strong>subject to</strong> <span class="math inline">\(\sum _{1 \le i \le n} c_{i}m_{i} \le c\)</span></p>
<p><span class="math inline">\(m_{i} \ge 1\)</span> and integer, <span class="math inline">\(1 \le  i \le n\)</span>.</p>
</div>
<p>since, we can assume each <span class="math inline">\(c_{i} \ge 0\)</span>, each <span class="math inline">\(m_{i}\)</span> must be in the range <span class="math inline">\(1 \le m_{i} \le u_{i}\)</span>, where <span class="math inline">\(u_{i}=\left \lfloor \frac{\left ( c+c_{i}-\sum_{j=1}^{n}{c_{j}} \right )}{c_{i}} \right \rfloor\)</span>. The upper bound <span class="math inline">\(u_{i}\)</span> follow from the observation that <span class="math inline">\(m_{j} \ge 1\)</span>. An optimal solution <span class="math inline">\(m_{1},m_{2},....m_{n}\)</span> is the result of a sequence of decisions, one decision for each <span class="math inline">\(m_{i}\)</span>.</p>
<p>Let <span class="math inline">\(f_{i}(x)\)</span> represents the maximum value of the <span class="math inline">\(\prod_{1 \le j \le i}{\Phi _{i}\left ( m_{j} \right ) }\)</span> subject to the constraints <span class="math inline">\(\sum _{1 \le j \le i}{c_{j}m_{j}} \le x\)</span> and <span class="math inline">\(1 \le m_{j} \le u_{j}, 1 \le j \le i\)</span>. Then, the value of an optimal solution is <span class="math inline">\(f_{n}(c)\)</span>.</p>
<p>The last decision made requires one to choose <span class="math inline">\(m_{n}\)</span> from <span class="math inline">\(\left \{ 1,2,3.......u_{n} \right \}\)</span>.</p>

    <p>Once a value for <span class="math inline">\(m_{n}\)</span> has been chosen, the remaining decisions must be such as to use the remaining funds <span class="math inline">\(c-c_{m}m_{n}\)</span> in an optimal way. The principle of the optimality holds.</p>
    <p>We can solve this problem of reliability design using dynamic programming strategy in the following way.</p>
    <p>The following is the recurrence relation for the optimal solution.</p>
<p><span class="math display">\[f_{n}(c)= \max _{1 \le m_{n} \le u_{n}}\left \{ \Phi _{n}(m_{n}) f_{n-1}(c-c_{n}m_{n})     \right \}\]</span></p>
<p>For any <span class="math inline">\(f_{i}(x)\)</span>, <span class="math inline">\(i \ge 1\)</span>, this equation generalizes in the following way.</p>
<p><span class="math display">\[f_{i}(x)= \max _{1 \le m_{i} \le u_{i}}\left \{ \Phi _{i}(m_{i}) f_{i-1}(c-c_{i}m_{i})     \right \}\]</span></p>
<p>Let <span class="math inline">\(S^{i}\)</span> consists tuples of the form <span class="math inline">\((f,x)\)</span>, where <span class="math inline">\(f=f_{i}(x)\)</span>.</p>
<p>There is at most one tuple for each different x that results from a sequence of decisions on <span class="math inline">\(m_{1},m_{2},....m_{n}\)</span>.</p>
<p>The dominance rule <span class="math inline">\((f_{1},x_{1})\)</span> dominates <span class="math inline">\((f_{2},x_{2})\)</span> if <span class="math inline">\(f_{1} \ge f_{2}\)</span> and <span class="math inline">\(x_{1} \le x_{2}\)</span> holds for this problem too. Hence, dominated tuples can be discarded from <span class="math inline">\(S^{i}\)</span>.</p>
  
 <h2 id="example">Example:</h2>
<p>We are designing a three stage system with device types <span class="math inline">\(D_{1},D_{2},D_{3}\)</span>. The cost are $ 30, $ 15, and $20 respectively. The cost of the system is to be no more than $ 105. The reliability of each device type is 0.9,0.8, and 0.5 respectively. We assume that if stage i has <span class="math inline">\(m_{i}\)</span> devices of type i in parallel, then <span class="math inline">\(\Phi _{i}( m_{i})= \left ( 1-r_{i} \right )^{m_{i}}\)</span>.</p>

    <p><strong>Solution:</strong></p>
    <p>The following is the problem data:</p>
<div class="center">
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center"><span class="math inline">\(m_{1}\)</span></th>
<th align="center"><span class="math inline">\(m_{2}\)</span></th>
<th align="center"><span class="math inline">\(m_{3}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Cost/unit</td>
<td align="center">30</td>
<td align="center">15</td>
<td align="center">20</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(c_{i}\)</span></td>
<td align="center">0.9</td>
<td align="center">0.8</td>
<td align="center">0.5</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(u_{i}\)</span></td>
<td align="center">2</td>
<td align="center">3</td>
<td align="center">3</td>
</tr>
</tbody>
</table>
</div>
<div class="center">
<p><span class="math inline">\(S_{1}^{1}\) : (adding the first copy of D1)</span></p>
<table>
<thead>
<tr class="header">
<th align="center">Reliability</th>
<th align="center">Cost</th>
<th align="center">Set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.9</td>
<td align="center">30</td>
<td align="center">(1,0,0)</td>
</tr>
</tbody>
</table>
</div>
<div class="center">
<p><span class="math inline">\(S_{2}^{1}\) :(adding the second copy of D1)</span></p>
<table>
<thead>
<tr class="header">
<th align="center">Reliability</th>
<th align="center">Cost</th>
<th align="center">Set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.9</td>
<td align="center">30</td>
<td align="center">(1,0,0)</td>
</tr>
<tr class="even">
<td align="center">0.99</td>
<td align="center">60</td>
<td align="center">(2,0,0)</td>
</tr>
</tbody>
</table>
</div>
<div class="center">
<p><span class="math inline">\(S_{1}^{2}\): (adding the first copy of D2)</span></p>
<table>
<thead>
<tr class="header">
<th align="center">Reliability</th>
<th align="center">Cost</th>
<th align="center">Set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.72</td>
<td align="center">45</td>
<td align="center">(1,1,0)</td>
</tr>
<tr class="even">
<td align="center">0.792</td>
<td align="center">75</td>
<td align="center">(2,1,0)</td>
</tr>
</tbody>
</table>
</div>
<div class="center">
<p><span class="math inline">\(S_{2}^{2}\):( adding the second copy of D2)</span></p>
<table>
<thead>
<tr class="header">
<th align="center">Reliability</th>
<th align="center">Cost</th>
<th align="center">Set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.864</td>
<td align="center">60</td>
<td align="center">(1,2,0)</td>
</tr>
<tr class="even">
<td align="center">0.9504</td>
<td align="center">90</td>
<td align="center">(2,2,0)</td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"></td>
<td align="center">The set (2,2,0) is not feasible.</td>
</tr>
</tbody>
</table>
  
  <p>The set (2,2,0) is not feasible. Because, the cost of (2,2,0) violates the constraint <span class="math inline">\(m_{i} \ge 1\)</span>. If you take (2,2,0) we can not afford <span class="math inline">\(D_{3}\)</span>. It is violating the constraints of the system.</p>

</div>
    
    
    <div class="center">
<p><span class="math inline">\(S_{2}^{2}\):  (adding the second copy of D2)</span></p>
<table>
<thead>
<tr class="header">
<th align="center">Reliability</th>
<th align="center">Cost</th>
<th align="center">Set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.864</td>
<td align="center">60</td>
<td align="center">(1,2,0)</td>
</tr>
</tbody>
</table>
</div>
<div class="center">
<p><span class="math inline">\(S_{3}^{2}\): (adding the third copy of D2)</span></p>
<table>
<thead>
<tr class="header">
<th align="center">Reliability</th>
<th align="center">Cost</th>
<th align="center">Set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.8928</td>
<td align="center">75</td>
<td align="center">(1,3,0)</td>
</tr>
</tbody>
</table>
</div>
<div class="center">
<p><span class="math inline">\(S^{2}\):(Collection of all feasible sets after adding D2 )</span></p>
<table>
<thead>
<tr class="header">
<th align="center">Reliability</th>
<th align="center">Cost</th>
<th align="center">Set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.72</td>
<td align="center">45</td>
<td align="center">(1,1,0)</td>
</tr>
<tr class="even">
<td align="center">0.792</td>
<td align="center">75</td>
<td align="center">(2,1,0)</td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"></td>
<td align="center">The set (2,1,0) will be eliminated.</td>
</tr>
<tr class="even">
<td align="center">0.864</td>
<td align="center">60</td>
<td align="center">(1,2,0)</td>
</tr>
<tr class="odd">
<td align="center">0.8928</td>
<td align="center">75</td>
<td align="center">(1,3,0)</td>
</tr>
</tbody>
</table>
<p>The reliability of the set (2,1,0) is 0.792 with a cost of 75. But, the reliability of the (1,2,0) is 0.864 with a cost of 60. The reliability of the set (1,2,0) more than the reliability of the (2,1,0), and the cost of the set (1,2,0) is less than the cost of the (2,1,0). Therefore, (2,1,0) is not a good choice than (1,2,0). Therefore, (2,1,0) is not proceeding for the further iteration.</p>
  
</div>
<div class="center">
<p><span class="math inline">\(S_{1}^{3}\):(adding the first copy of D3)</span></p>
<table>
<thead>
<tr class="header">
<th align="center">Reliability</th>
<th align="center">Cost</th>
<th align="center">Set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.36</td>
<td align="center">65</td>
<td align="center">(1,1,1)</td>
</tr>
<tr class="even">
<td align="center">0.432</td>
<td align="center">80</td>
<td align="center">(1,2,1)</td>
</tr>
<tr class="odd">
<td align="center">0.4964</td>
<td align="center">95</td>
<td align="center">(1,3,1)</td>
</tr>
<tr class="even">
<td align="center"></td>
<td align="center"></td>
<td align="center">For the set (1,3,1), we can not add any more device unit.</td>
</tr>
</tbody>
</table>
</div>
<div class="center">
<p><span class="math inline">\(S_{2}^{3}\):(adding the second copy of D3)</span></p>
<table>
<thead>
<tr class="header">
<th align="center">Reliability</th>
<th align="center">Cost</th>
<th align="center">Set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.54</td>
<td align="center">85</td>
<td align="center">(1,1,2)</td>
</tr>
<tr class="even">
<td align="center">0.648</td>
<td align="center">100</td>
<td align="center">(1,2,2)</td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center"></td>
<td align="center">For the set (1,2,2), we can not add any more device unit.</td>
</tr>
</tbody>
</table>
</div>

<div class="center">
<p><span class="math inline">\(S_{3}^{3}\):(adding the third copy of D3)</span></p>
<table>
<thead>
<tr class="header">
<th align="center">Reliability</th>
<th align="center">Cost</th>
<th align="center">Set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.63</td>
<td align="center">105</td>
<td align="center">(1,1,3)</td>
</tr>
</tbody>
</table>
</div>
<div class="center">
<p><span class="math inline">\(S^{3}\):(Collection of all feasible sets after adding D3)</span></p>
<table>
<thead>
<tr class="header">
<th align="center">Reliability</th>
<th align="center">Cost</th>
<th align="center">Set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.4964</td>
<td align="center">95</td>
<td align="center">(1,3,1)</td>
</tr>
<tr class="even">
<td align="center">0.648</td>
<td align="center">100</td>
<td align="center">(1,2,2)</td>
</tr>
<tr class="odd">
<td align="center">0.63</td>
<td align="center">105</td>
<td align="center">(1,1,3)</td>
</tr>
</tbody>
</table>
</div>
<p>Therefore, the best design has a reliability of 0.648 and a cost of 100. The number of copies of <span class="math inline">\(m_{1}=1, m_{2}=2, m_{3}=2\)</span></p>
    

<h1 id="code">Let's get our hands dirty: Dynamic Programming with Coding</h1>

<p>We will try to understand Dynamic Programming with the help of an example.</p> 

<p>Govt. of India has a budget of Rs. <strong>420</strong> Crores. GoI has decided to distribute to this budget to various PSUs based on their demands and expected profit. GoI wants to allocated money in such that it will maximize the expected benefit. Constraint: Either the demand of a PSU is full filled completely or will not be considered at all.</p>

<table class="center">
  <tr>
    <th>PSU</th>
    <th>Budget Required (Cost) (in Crs.)</th>
    <th>Expected Benefit (in Crs.)</th>
  </tr>
  <tr>
    <td>ONGC</td>
    <td>28</td>
    <td>592</td>
  </tr>
  <tr>
    <td>IOCL</td>
    <td>17</td>
    <td>314</td>
  </tr>
  <tr>
    <td>NTPC</td>
    <td>10</td>
    <td>157</td>
  </tr>
  <tr>
    <td>PGCIL</td>
    <td>32</td>
    <td>300</td>
  </tr>
  <tr>
    <td>ISRO</td>
    <td>152</td>
    <td>1051</td>
  </tr>
  <tr>
    <td>GAIL</td>
    <td>24</td>
    <td>116</td>
  </tr>
  <tr>
    <td>SAIL</td>
    <td>160</td>
    <td>673</td>
  </tr>
  <tr>
    <td>BEL</td>
    <td>7</td>
    <td>23</td>
  </tr>
  <tr>
    <td>OIL</td>
    <td>94</td>
    <td>232</td>
  </tr>
  <tr>
    <td>BHEL</td>
    <td>101</td>
    <td>184</td>
  </tr>
</table>

<p>Now, this problem is an optimization problem. </p>

<center>
<div style="text-align: left;  margin-left: 600px;">
<!-- <p> -->
<strong>Maximize</strong> <span class="math inline">\(\sum\limits_{i=1}^{10} b_ix_i \)</span><br>
s.t. <br><span class="math inline"><br>\(\sum\limits_{i=1}^{10} c_ix_i \le B\)</span><br>
<span class="math inline">\(x_i \in \{0,1\}\ \forall i \in \{1,2,...,10\}\)</span><br><br>
where,<br>
<span class="math inline">\(c_i\)</span> represents the cost required by <span class="math inline">\(i^{th}\)</span> PSU <br>
<span class="math inline">\(b_i\)</span> represents the benefit from the <span class="math inline">\(i^{th}\)</span> PSU <br>
<span class="math inline">\(x_i=1\)</span> represents GoI allocated buget to  <span class="math inline">\(i^{th}\)</span> PSU, otherwise not<br>
<span class="math inline">\(B\)</span> represents the budget GoI has
<!-- </p>   -->
</div>
</center>

<p>Here, we can't directly use simplex method for solving LPP. It is because this problem has a special constraint on <span class="math inline">\(x_i\)</span> which makes it Integer Programming Problem which can be easily solved using DP. This problem reduces to a standard problem of DP which is 0/1 Knapsack Problem.</p>


<p>Let's first define the variables.</p>
<pre>
  <code>import numpy as np <br>
organizations = ['ONGC', 'IOCL', 'NTPC', 'PGCIL', 'ISRO', 'GAIL', 'SAIL', 'BEL', 'OIL', 'BHEL']
benefit = np.array([592, 314, 157, 300, 1051, 116, 673, 23, 232, 184], dtype=np.int)
cost = np.array([28, 17, 10, 32, 152, 24, 160, 7, 94, 101], dtype=np.int)
	
budget = 420
n = len(cost)</code>
</pre>

<p>The Dynamic Programming Code:</p>

<pre>
  <code>dp = np.zeros((n+1, budget+1), dtype=np.int)

for i in range(n + 1): 
  for b in range(budget + 1): 
    if i == 0 or b == 0: 
        dp[i][b] = 0
    elif cost[i-1] <= b: 
        dp[i][b] = max(benefit[i-1] + dp[i-1][b-cost[i-1]], dp[i-1][b]) 
    else: 
        dp[i][b] = dp[i-1][b] 

print('Profit made by government by optimally distributing funds: Rs.', dp[n][budget], 'Cr')</code>
</pre>

<p>
	The Profit made by GoI is Rs. 3110 Crs. by optimially allocating 420 Crs. 
</p>


<pre>
  <code>profit = dp[n][budget]
b = budget
allocat_org = []
for i in range(n, 0, -1): 
    if profit <= 0: 
        break
    if profit == dp[i-1][b]: 
        continue
    else:
        allocat_org.append(organizations[i-1])
        profit = profit - benefit[i-1] 
        b = b - cost[i-1] 

print('Organizations which will get required funds:')
for iter, x in enumerate(allocat_org):
  print(x)</code>
</pre>


<p>Organizations which will get required funds are:
	<table class="center" border="1">
		<tr>
			<th style="text-align:center">BEL</th>
			<th style="text-align:center">SAIL</th>
			<th style="text-align:center">ISRO</th>
			<th style="text-align:center">PGCIL</th>
			<th style="text-align:center">NTPC</th>
			<th style="text-align:center">IOCL</th>
			<th style="text-align:center">ONGC</th>
		</tr>
	</table>
</p>

<p>Dynamic Programming will always provide global solution by doing minimum computations. Hence, here no matter how we solve we will always reach to same solution.</p>

  </body>
  </html>


